{% extends 'home/base.html' %} {% block content %}

<body id="home" class="layout-default dvc-ios demo">
  {% include 'home/header.html' %}

  <div class="content loc-home sec-default no-breadcrumbs" class="default-font font-size-14">
    <div id="flashbox" class="container" class="default-font font-size-14">
      <div class="wrap" class="default-font font-size-14"><div class="wrap2" class="default-font font-size-14"></div></div>
    </div>
    <div class="container banner-box is-demo" class="default-font font-size-14">
      <div class="inside" class="default-font font-size-14">
        <div id="banner-theme" class="banner-theme banner-home_top not767 is-demo" class="default-font font-size-14">
          <div class="myad" speechify-initial-font-family="monospace" speechify-initial-font-size="14px">
            <div class="text" speechify-initial-font-family="monospace" speechify-initial-font-size="16px">
              <a href="https://www.a2hosting.com?aid=5ff74858d3bac&amp;bid=a3194333" target="_top" speechify-initial-font-family="monospace" speechify-initial-font-size="16px"><img src="//affiliates.a2hosting.com/accounts/default1/banners/a3194333.jpg" alt="" title="" width="728" height="90" speechify-initial-font-family="monospace" speechify-initial-font-size="16px" /></a><img style="border: 0" src="https://affiliates.a2hosting.com/scripts/imp.php?aid=5ff74858d3bac&amp;bid=a3194333" width="1" height="1" alt="" speechify-initial-font-family="monospace" speechify-initial-font-size="16px" />
            </div>
          </div>
        </div>
      </div>
    </div>

    <section class="home-search" class="default-font font-size-14">
      <div class="container" class="default-font font-size-14">
        <div class="box" class="default-font font-size-14">
          <h1 class="default-font font-size-28">
            What would you like to
            <div class="default-font font-size-28">
              <span class="l1" class="default-font font-size-28">buy?</span>
              <span class="l2" class="default-font font-size-28">sell?</span>
              <span class="l3" class="default-font font-size-28">exchange?</span>
              <span class="l4" class="default-font font-size-28">rent?</span>
              <span class="l5" class="default-font font-size-28">buy?</span>
            </div>
          </h1>

          <form action="#" method="GET" class="nocsrf" class="default-font font-size-14">
            <input type="hidden" name="page" value="search" class="default-font font-size-15" />

            <div class="input-box picker pattern" class="default-font font-size-14">
              <input type="text" name="sPattern" class="pattern" placeholder="Enter keyword..." value="" autocomplete="off" class="default-font font-size-17" />
              <i class="clean fas fa-times-circle" speechify-initial-font-family='"Font Awesome 5 Free"' speechify-initial-font-size="18px"></i>
              <div class="results" class="default-font font-size-14" style="overflow: hidden">
                <div class="loaded" class="default-font font-size-14"></div>
                <div class="default" class="default-font font-size-14">
                  <div class="row minlength" class="default-font font-size-13">
                    <em class="default-font font-size-13">Enter <span class="min" class="default-font font-size-13">2</span> more character(s) to search...</em>
                  </div>
                  <div class="row cities locations" class="default-font font-size-14">
                    <div class="lead" class="default-font font-size-13">Popular cities</div>
                    <a class="option direct" href="https://epsilon.mb-themes.com/ireton-c6862204" data-city="6862204" class="default-font font-size-15">Ireton, Iowa <em class="default-font font-size-11">253 items</em></a
                    ><a class="option direct" href="https://epsilon.mb-themes.com/kerens-c6703063" data-city="6703063" class="default-font font-size-15">Kerens, Texas <em class="default-font font-size-11">97 items</em></a
                    ><a class="option direct" href="https://epsilon.mb-themes.com/audubon-c6500572" data-city="6500572" class="default-font font-size-15">Audubon, New Jersey <em class="default-font font-size-11">3 items</em></a
                    ><a class="option direct" href="https://epsilon.mb-themes.com/atlantic-highlands-c7095312" data-city="7095312" class="default-font font-size-15">Atlantic Highlands, New Jersey <em class="default-font font-size-11">2 items</em></a
                    ><a class="option direct" href="https://epsilon.mb-themes.com/borkowice-c9532517" data-city="9532517" class="default-font font-size-15">Borkowice, Mazovia <em class="default-font font-size-11">1 item</em></a
                    ><a class="option direct" href="https://epsilon.mb-themes.com/alice-c6670234" data-city="6670234" class="default-font font-size-15">Alice, Texas <em class="default-font font-size-11">1 item</em></a>
                  </div>
                </div>
              </div>
            </div>

            <button class="btn" type="submit" class="default-font font-size-16"><i class="fa fa-search" speechify-initial-font-family='"Font Awesome 5 Free"' speechify-initial-font-size="16px"></i> <span class="default-font font-size-16">Search</span></button>
          </form>

          <h2 class="default-font font-size-17">Categories</h2>

          <div id="home-cat" class="default-font font-size-14">
            <!-- Loop through each category -->
            {% for category in categories %}
            <a href="{% url 'product:product_list_by_category' category.slug %}" data-id="{{ category.id }}" class="default-font font-size-14">
              <div class="category-icon">
                <!-- Display category image if available -->
                {% if category.icon %}
                <img src="{{ category.icon.url }}" alt="{{ category.title }}" class="lazy" class="default-font font-size-14" />
                {% else %}
                <!-- Fallback icon or image -->
                {% endif %}
              </div>
              <h3 class="default-font font-size-18"><span class="default-font font-size-14">{{ category.title }}</span></h3>
            </a>
            {% endfor %}
          </div>
        </div>
      </div>
    </section>

    {% include 'home/today_most_viewd.html' %} {% include 'home/latest_listings.html' %} {% comment %} {% include 'home/blog.html' %} {% endcomment %}

    <div class="container banner-box is-demo" class="default-font font-size-14">
      <div class="inside" class="default-font font-size-14">
        <div id="banner-theme" class="banner-theme banner-home_middle not767 is-demo" class="default-font font-size-14">
          <div class="myad" speechify-initial-font-family="monospace" speechify-initial-font-size="14px">
            <div class="text" speechify-initial-font-family="monospace" speechify-initial-font-size="16px">
              <a href="https://www.a2hosting.com?aid=5ff74858d3bac&amp;bid=a3194333" target="_top" speechify-initial-font-family="monospace" speechify-initial-font-size="16px"><img src="//affiliates.a2hosting.com/accounts/default1/9u7wabf7le4/a3194333.jpg" alt="" title="" width="728" height="90" speechify-initial-font-family="monospace" speechify-initial-font-size="16px" /></a><img style="border: 0" src="https://affiliates.a2hosting.com/scripts/9u7waif7le4?aid=5ff74858d3bac&amp;bid=a3194333" width="1" height="1" alt="" speechify-initial-font-family="monospace" speechify-initial-font-size="16px" />
            </div>
          </div>
        </div>
      </div>
    </div>

    {% comment %} {% include 'home/most_favorite_list.html' %} {% endcomment %} {% include 'home/rec_companies.html' %} {% comment %} {% include 'home/best_sellers.html' %} {% endcomment %}

    <div class="container banner-box is-demo" class="default-font font-size-14">
      <div class="inside" class="default-font font-size-14">
        <div id="banner-theme" class="banner-theme banner-home_bottom not767 is-demo" class="default-font font-size-14">
          <div class="myad" speechify-initial-font-family="monospace" speechify-initial-font-size="14px">
            <div class="text" speechify-initial-font-family="monospace" speechify-initial-font-size="16px">
              <a href="https://www.a2hosting.com/wordpress-hosting/managed?aid=5ff74858d3bac&amp;bid=0ffde563" target="_top" speechify-initial-font-family="monospace" speechify-initial-font-size="16px"><img src="//affiliates.a2hosting.com/accounts/default1/9u7wabf7le4/0ffde563.jpg" alt="managed osclass hosting" title="managed osclass hosting" width="728" height="90" speechify-initial-font-family="monospace" speechify-initial-font-size="16px" /></a><img style="border: 0" src="https://affiliates.a2hosting.com/scripts/9u7waif7le4?aid=5ff74858d3bac&amp;bid=0ffde563" width="1" height="1" alt="" speechify-initial-font-family="monospace" speechify-initial-font-size="16px" />
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <section class="promo" class="default-font font-size-16">
    <div class="container" class="default-font font-size-16">
      <span class="default-font font-size-16">Are you a professional seller?</span>
      <a href="https://epsilon.mb-themes.com/user/register" class="btn btn-transparent" class="default-font font-size-16">Create an account</a>
    </div>
  </section>
  {% include 'home/footer.html' %} {% include 'home/mobile_bottom_bar.html' %}

  <div id="body-banner" class="bleft" class="default-font font-size-14">
    <div id="banner-theme" class="banner-theme banner-body_left not767 is-demo" class="default-font font-size-14">
      <div class="myad" speechify-initial-font-family="monospace" speechify-initial-font-size="14px">
        <div class="text" speechify-initial-font-family="monospace" speechify-initial-font-size="16px">
          <a href="https://www.a2hosting.com?aid=5ff74858d3bac&amp;bid=a504f205" target="_top" speechify-initial-font-family="monospace" speechify-initial-font-size="16px"><img src="//affiliates.a2hosting.com/accounts/default1/9u7wabf7le4/a504f205.jpg" alt="" title="" width="160" height="600" speechify-initial-font-family="monospace" speechify-initial-font-size="16px" /></a><img style="border: 0" src="https://affiliates.a2hosting.com/scripts/9u7waif7le4?aid=5ff74858d3bac&amp;bid=a504f205" width="1" height="1" alt="" speechify-initial-font-family="monospace" speechify-initial-font-size="16px" />
        </div>
      </div>
    </div>
  </div>

  <div id="body-banner" class="bright" class="default-font font-size-14">
    <div id="banner-theme" class="banner-theme banner-body_right not767 is-demo" class="default-font font-size-14">
      <div class="myad" speechify-initial-font-family="monospace" speechify-initial-font-size="14px">
        <div class="text" speechify-initial-font-family="monospace" speechify-initial-font-size="16px">
          <a href="https://www.a2hosting.com?aid=5ff74858d3bac&amp;bid=a504f205" target="_top" speechify-initial-font-family="monospace" speechify-initial-font-size="16px"><img src="//affiliates.a2hosting.com/accounts/default1/9u7wabf7le4/a504f205.jpg" alt="" title="" width="160" height="600" speechify-initial-font-family="monospace" speechify-initial-font-size="16px" /></a><img style="border: 0" src="https://affiliates.a2hosting.com/scripts/9u7waif7le4?aid=5ff74858d3bac&amp;bid=a504f205" width="1" height="1" alt="" speechify-initial-font-family="monospace" speechify-initial-font-size="16px" />
        </div>
      </div>
    </div>
  </div>

  <a id="scroll-to-top" class="default-font font-size-14"
    ><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="20" height="20" class="default-font font-size-14"><path d="M24 32h336c13.3 0 24 10.7 24 24v24c0 13.3-10.7 24-24 24H24C10.7 104 0 93.3 0 80V56c0-13.3 10.7-24 24-24zm232 424V320h87.7c17.8 0 26.7-21.5 14.1-34.1L205.7 133.7c-7.5-7.5-19.8-7.5-27.3 0L26.1 285.9C13.5 298.5 22.5 320 40.3 320H128v136c0 13.3 10.7 24 24 24h80c13.3 0 24-10.7 24-24z" class="default-font font-size-14"></path></svg
  ></a>

  <div id="menu-cover" class="mobile-box" class="default-font font-size-14">
    <svg class="close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" width="32px" height="32px" class="default-font font-size-14"><path fill="currentColor" d="M193.94 256L296.5 153.44l21.15-21.15c3.12-3.12 3.12-8.19 0-11.31l-22.63-22.63c-3.12-3.12-8.19-3.12-11.31 0L160 222.06 36.29 98.34c-3.12-3.12-8.19-3.12-11.31 0L2.34 120.97c-3.12 3.12-3.12 8.19 0 11.31L126.06 256 2.34 379.71c-3.12 3.12-3.12 8.19 0 11.31l22.63 22.63c3.12 3.12 8.19 3.12 11.31 0L160 289.94 262.56 392.5l21.15 21.15c3.12 3.12 8.19 3.12 11.31 0l22.63-22.63c3.12-3.12 3.12-8.19 0-11.31L193.94 256z" class="" class="default-font font-size-14"></path></svg>
  </div>

  {% include 'home/side_menu.html' %}
  <script>
    function getLocation() {
      if ("geolocation" in navigator) {
        navigator.geolocation.getCurrentPosition(
          (position) => sendDataToBackend(position.coords.latitude, position.coords.longitude),
          (error) => {
            console.log("Geolocation error:", error);
            getLocationFromIP(); // Fallback to IP location
          }
        );
      } else {
        console.log("Geolocation is not available.");
        getLocationFromIP(); // Fallback to IP location
      }
    }

    function getLocationFromIP() {
      fetch("https://ipinfo.io/json?token=a09cd3c882d35c")
        .then((response) => response.json())
        .then((data) => {
          const [latitude, longitude] = data.loc.split(",");
          const country = data.country;
          const city = data.city;

          console.log("Country: ", country, "City: ", city); // Log country and city to console

          sendDataToBackend(latitude, longitude);
        })
        .catch((error) => console.error("Error fetching IP location:", error));
    }

    function sendDataToBackend(latitude, longitude) {
      console.log("Sending data to backend: ", latitude, longitude);
      fetch("/save-location/", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "X-CSRFToken": getCookie("csrftoken"),
        },
        body: JSON.stringify({ latitude: latitude, longitude: longitude }),
      })
        .then((response) => response.json())
        .then((data) => {
          console.log("Response from server: ", data);
        })
        .catch((error) => {
          console.error("Error sending data to backend: ", error);
        });
    }

    function getCookie(name) {
      let cookieValue = null;
      if (document.cookie && document.cookie !== "") {
        const cookies = document.cookie.split(";");
        for (let i = 0; i < cookies.length; i++) {
          const cookie = cookies[i].trim();
          if (cookie.substring(0, name.length + 1) === name + "=") {
            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
            break;
          }
        }
      }
      return cookieValue;
    }

    window.onload = getLocation;
  </script>
</body>
{% endblock %}
